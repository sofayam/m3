%%BoundingBox: 10 27 511 314
%%HiResBoundingBox: 10.196055 27.381097 510.319654 313.186697
%
% Postscript macros for the avatars and connections
%


% Arrow code copied from the Tutorial and Cookbook (p.143)
/arrowdict 14 dict def
  arrowdict begin
    /mtrx matrix def
  end

/arrow
  {arrowdict begin
    /headlength exch def
    /halfheadthickness exch 2 div def
    /halfthickness exch 2 div def
    /tipy exch def /tipx exch def
    /taily exch def /tailx exch def

    /dx tipx tailx sub def
    /dy tipy taily sub def
    /arrowlength dx dx mul dy dy mul add sqrt def
    /angle dy dx atan def

    /base arrowlength headlength sub def
    /savematrix mtrx currentmatrix def

    tailx taily translate
    angle rotate

    0 halfthickness neg moveto
    base halfthickness neg lineto
    base halfheadthickness neg lineto
    arrowlength 0 lineto
    base halfheadthickness lineto
    base halfthickness lineto
    0 halfthickness lineto
    closepath

    savematrix setmatrix
  end
} def


% The following algorithms are copyright Mark Andrew 2003 :-)
/square
{
    newpath
    /ey exch def
    /ex exch def
    /sy exch def
    /sx exch def
    sx sy moveto
    ex sy lineto
    ex ey lineto
    sx ey lineto
    closepath
    gsave 1 1 1 setrgbcolor fill grestore  % paint it all white
    stroke
} def

/oval
{
    /cy exch def
    /cx exch def
    /rx exch def    
    /scaley exch def
    
    gsave
    newpath
    cx cy translate
    1 scaley scale

    0 0  rx
    0 360 arc 

    %1 1 1 setrgbcolor fill


    closepath
    stroke	
    grestore

} def



% Show the string on top of stack centred on current point
% TBD the  y-offset is hardwired assuming a tenpoint font 
/showmiddle { dup stringwidth pop 2 div neg 4 rmoveto show } def

% And now the stuff we always need to do

% this gets us into Tk screen coordinates (700x500)

%306 396 translate
%90 rotate
%-396 -306 translate
1 -1 scale
%0 -500 translate

% TBD Only one font for the whole Kaboodle for the time being

/Times-Roman findfont [10 0 0 -10 0 0] makefont setfont

%
% And now for the code generated by the capsule editor .....
%
10 -341 translate
0.639386189258 0.639386189258 scale
gsave 0.0 0.0 0.0 setrgbcolor
107.0 44.0 782.0 490.0 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
87.0 88.5139034222 127.0 128.513903422 square
grestore
107.0 92.5139034222 moveto (counter) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
87.0 274.086118172 127.0 314.086118172 square
grestore
107.0 278.086118172 moveto (wall) showmiddle
184.0 369.0 moveto (emitCash) show
newpath 195.179028239 359.0 177.46165445 349.72127886 1 5 7 arrow stroke
209.0 288.0 moveto (returnCard) show
newpath 209.0 285.351134698 189.000254645 285.250210355 1 5 7 arrow stroke
195.0 305.0 moveto (insertCard) show
newpath 252.0 302.643819021 271.999745355 302.744743364 1 5 7 arrow stroke
185.0 215.0 moveto (inputPIN) show
185.0 225.0 moveto (inputSum) show
newpath 238.0 208.183549436 256.266324109 200.038526198 1 5 7 arrow stroke
269 102 moveto (deposit) show
newpath 311 99.0394912874 330.999964636 99.0771019709 1 5 7 arrow stroke
24 109 moveto (deposit) show
newpath 66 107.050862769 85.9835797902 107.050862769 1 5 7 arrow stroke
21 315 moveto (returnCard) show
21 325 moveto (emitCash) show
newpath 20 321.647740262 1.7932469777 321.647740262 1 5 7 arrow stroke
7 270 moveto (inputPIN) show
7 280 moveto (inputSum) show
7 290 moveto (insertCard) show
newpath 64 283.470287061 83.7240394511 283.470287061 1 5 7 arrow stroke
gsave 0.0 0.0 0.0 setrgbcolor
552.0 68.0 711.0 331.0 square
grestore
631.5 199.5 moveto (account) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
319.0 169.0 472.0 436.0 square
grestore
395.5 302.5 moveto (atm) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
542.0 237.79398315 562.0 257.79398315 square
grestore
552.0 241.79398315 moveto (information) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
542.0 99.3507426082 562.0 119.350742608 square
grestore
552.0 103.350742608 moveto (movement) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
462.0 243.402102135 482.0 263.402102135 square
grestore
472.0 247.402102135 moveto (accounting) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
309.0 395.112103458 329.0 415.112103458 square
grestore
319.0 399.112103458 moveto (cashSlot) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
309.0 285.155929833 329.0 305.155929833 square
grestore
319.0 289.155929833 moveto (cardSlot) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
309.0 189.554513662 329.0 209.554513662 square
grestore
319.0 193.554513662 moveto (keyboard) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor newpath 127.0 108.551514172 542.0 109.331937233 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 127.0 285.168042274 309.0 204.01355161 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 127.0 294.1870438 309.0 295.105467019 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 127.0 304.560267727 309.0 399.875028681 1 5 7 arrow stroke grestore
