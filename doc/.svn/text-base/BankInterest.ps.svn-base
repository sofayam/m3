%%BoundingBox: 10 33 511 350
%%HiResBoundingBox: 10.332000 33.734398 510.332003 349.803451
%
% Postscript macros for the avatars and connections
%


% Arrow code copied from the Tutorial and Cookbook (p.143)
/arrowdict 14 dict def
  arrowdict begin
    /mtrx matrix def
  end

/arrow
  {arrowdict begin
    /headlength exch def
    /halfheadthickness exch 2 div def
    /halfthickness exch 2 div def
    /tipy exch def /tipx exch def
    /taily exch def /tailx exch def

    /dx tipx tailx sub def
    /dy tipy taily sub def
    /arrowlength dx dx mul dy dy mul add sqrt def
    /angle dy dx atan def

    /base arrowlength headlength sub def
    /savematrix mtrx currentmatrix def

    tailx taily translate
    angle rotate

    0 halfthickness neg moveto
    base halfthickness neg lineto
    base halfheadthickness neg lineto
    arrowlength 0 lineto
    base halfheadthickness lineto
    base halfthickness lineto
    0 halfthickness lineto
    closepath

    savematrix setmatrix
  end
} def


% The following algorithms are copyright Mark Andrew 2003 :-)
/square
{
    newpath
    /ey exch def
    /ex exch def
    /sy exch def
    /sx exch def
    sx sy moveto
    ex sy lineto
    ex ey lineto
    sx ey lineto
    closepath
    gsave 1 1 1 setrgbcolor fill grestore  % paint it all white
    stroke
} def

/oval
{
    /cy exch def
    /cx exch def
    /rx exch def    
    /scaley exch def
    
    gsave
    newpath
    cx cy translate
    1 scaley scale

    0 0  rx
    0 360 arc 

    %1 1 1 setrgbcolor fill


    closepath
    stroke	
    grestore

} def



% Show the string on top of stack centred on current point
% TBD the  y-offset is hardwired assuming a tenpoint font 
/showmiddle { dup stringwidth pop 2 div neg 4 rmoveto show } def

% And now the stuff we always need to do

% this gets us into Tk screen coordinates (700x500)

%306 396 translate
%90 rotate
%-396 -306 translate
1 -1 scale
%0 -500 translate

% TBD Only one font for the whole Kaboodle for the time being

/Times-Roman findfont [10 0 0 -10 0 0] makefont setfont

%
% And now for the code generated by the capsule editor .....
%
10 -384 translate
0.66401062417 0.66401062417 scale
gsave 0.0 0.0 0.0 setrgbcolor
124.0 52.0 753.0 527.0 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
104.0 385.697278071 144.0 425.697278071 square
grestore
124.0 389.697278071 moveto (admin) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
104.0 458.241424605 144.0 498.241424605 square
grestore
124.0 462.241424605 moveto (mail) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
104.0 92.5255032228 144.0 132.525503223 square
grestore
124.0 96.5255032228 moveto (counter) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
104.0 228.388893458 144.0 268.388893458 square
grestore
124.0 232.388893458 moveto (wall) showmiddle
521.901082785 395.5 moveto (requestBalance) show
newpath 575.070375964 385.5 591.674373787 374.350683595 1 5 7 arrow stroke
477.0 204.5 moveto (withdraw) show
newpath 508.131159806 194.5 520.139565022 178.506307363 1 5 7 arrow stroke
204.5 490.100762381 moveto (statement) show
newpath 204.5 487.820355589 184.500661437 487.983011845 1 5 7 arrow stroke
172.5 419.684733351 moveto (setInterestRate) show
newpath 255.5 417.059287766 275.499908628 416.998832338 1 5 7 arrow stroke
185.042921832 304.313727142 moveto (emitCash) show
newpath 192.879206386 294.313727142 174.469933204 286.4971639 1 5 7 arrow stroke
208.0 239.718630986 moveto (returnCard) show
newpath 208.0 237.105771111 188.000146363 237.029256501 1 5 7 arrow stroke
199.0 259.718630986 moveto (insertCard) show
newpath 256.0 257.327665103 275.999853637 257.404179713 1 5 7 arrow stroke
168.02721007 177.7401172 moveto (inputPIN) show
168.02721007 187.7401172 moveto (inputSum) show
newpath 221.02721007 169.208383021 238.839364566 160.112936236 1 5 7 arrow stroke
321.0 104.5 moveto (deposit) show
newpath 363.0 101.99088864 382.999998118 101.982211156 1 5 7 arrow stroke
0.0 403.369466703 moveto (setInterestRate) show
newpath 83.0 402.948016549 102.965843055 402.948016549 1 5 7 arrow stroke
38.0 475.201524763 moveto (statement) show
newpath 38.0 474.05746289 18.0875869898 474.05746289 1 5 7 arrow stroke
33 113 moveto (deposit) show
newpath 75 111.050683153 94.9869960274 111.050683153 1 5 7 arrow stroke
24.0 271.536901498 moveto (returnCard) show
24.0 281.536901498 moveto (emitCash) show
newpath 24.0 278.125121448 5.4257464748 278.125121448 1 5 7 arrow stroke
24.0 227.536901498 moveto (inputPIN) show
24.0 237.536901498 moveto (inputSum) show
24.0 247.536901498 moveto (insertCard) show
newpath 81.0 241.471590499 100.864932394 241.471590499 1 5 7 arrow stroke
gsave 0.0 0.0 0.0 setrgbcolor
304.0 374.0 460.0 493.0 square
grestore
382.0 433.5 moveto (interest) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
541.0 83.0 722.0 320.0 square
grestore
631.5 201.5 moveto (account) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
307.0 136.0 459.0 338.0 square
grestore
383.0 237.0 moveto (atm) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
294.0 466.777469885 314.0 486.777469885 square
grestore
304.0 470.777469885 moveto (mail) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
450.0 418.590048755 470.0 438.590048755 square
grestore
460.0 422.590048755 moveto (account) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
294.0 395.153176736 314.0 415.153176736 square
grestore
304.0 399.153176736 moveto (admin) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
611.71654545 310.0 631.71654545 330.0 square
grestore
621.71654545 314.0 moveto (information) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
531.0 102.344577653 551.0 122.344577653 square
grestore
541.0 106.344577653 moveto (movement) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
449.0 211.55831358 469.0 231.55831358 square
grestore
459.0 215.55831358 moveto (accounting) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
297.0 316.090552785 317.0 336.090552785 square
grestore
307.0 320.090552785 moveto (cashSlot) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
297.0 239.089007262 317.0 259.089007262 square
grestore
307.0 243.089007262 moveto (cardSlot) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
297.0 144.943332901 317.0 164.943332901 square
grestore
307.0 148.943332901 moveto (keyboard) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor newpath 144.0 112.516825737 531.0 112.348916395 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 144.0 238.176263889 297.0 160.049647686 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 144.0 248.465408628 297.0 249.050749677 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 144.0 256.880878084 297.0 321.844560472 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 144.0 405.636822367 294.0 405.183404588 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 144.0 478.07876297 294.0 476.858800703 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 466.508213074 211.55831358 533.491786926 122.344577653 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 470.0 421.875210242 611.71654545 326.714838513 1 5 7 arrow stroke grestore
