%%BoundingBox: 12 46 511 324
%%HiResBoundingBox: 12.168000 46.944987 510.474355 323.036054
%
% Postscript macros for the avatars and connections
%


% Arrow code copied from the Tutorial and Cookbook (p.143)
/arrowdict 14 dict def
  arrowdict begin
    /mtrx matrix def
  end

/arrow
  {arrowdict begin
    /headlength exch def
    /halfheadthickness exch 2 div def
    /halfthickness exch 2 div def
    /tipy exch def /tipx exch def
    /taily exch def /tailx exch def

    /dx tipx tailx sub def
    /dy tipy taily sub def
    /arrowlength dx dx mul dy dy mul add sqrt def
    /angle dy dx atan def

    /base arrowlength headlength sub def
    /savematrix mtrx currentmatrix def

    tailx taily translate
    angle rotate

    0 halfthickness neg moveto
    base halfthickness neg lineto
    base halfheadthickness neg lineto
    arrowlength 0 lineto
    base halfheadthickness lineto
    base halfthickness lineto
    0 halfthickness lineto
    closepath

    savematrix setmatrix
  end
} def


% The following algorithms are copyright Mark Andrew 2003 :-)
/square
{
    newpath
    /ey exch def
    /ex exch def
    /sy exch def
    /sx exch def
    sx sy moveto
    ex sy lineto
    ex ey lineto
    sx ey lineto
    closepath
    gsave 1 1 1 setrgbcolor fill grestore  % paint it all white
    stroke
} def

/oval
{
    /cy exch def
    /cx exch def
    /rx exch def    
    /scaley exch def
    
    gsave
    newpath
    cx cy translate
    1 scaley scale

    0 0  rx
    0 360 arc 

    %1 1 1 setrgbcolor fill


    closepath
    stroke	
    grestore

} def



% Show the string on top of stack centred on current point
% TBD the  y-offset is hardwired assuming a tenpoint font 
/showmiddle { dup stringwidth pop 2 div neg 4 rmoveto show } def

% And now the stuff we always need to do

% this gets us into Tk screen coordinates (700x500)

%306 396 translate
%90 rotate
%-396 -306 translate
1 -1 scale
%0 -500 translate

% TBD Only one font for the whole Kaboodle for the time being

/Times-Roman findfont [10 0 0 -10 0 0] makefont setfont

%
% And now for the code generated by the capsule editor .....
%
10 -370 translate
0.948766603416 0.948766603416 scale
gsave 0.0 0.0 0.0 setrgbcolor
80.0 50 527.0 340.0 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
60.0 177.029687945 100.0 217.029687945 square
grestore
80.0 181.029687945 moveto (p1) showmiddle
119 189 moveto (a21) show
newpath 135 184.944885318 154.999525388 184.807101884 1 5 7 arrow stroke
323 161 moveto (s2) show
323 171 moveto (s1) show
newpath 334 162.934797132 353.998819156 162.71746707 1 5 7 arrow stroke
2 184 moveto (a21) show
2 194 moveto (setup) show
2 204 moveto (summary) show
newpath 42 193.003753029 61.9252200741 193.003753029 1 5 7 arrow stroke
gsave 0.0 0.0 0.0 setrgbcolor
375.954458746 108.380285962 500.954458746 281.380285962 square
grestore
438.454458746 194.880285962 moveto (capRTC22) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
196.055050299 107.381891119 306.055050299 284.381891119 square
grestore
251.055050299 195.881891119 moveto (capRTC21) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
365.954458746 171.017364032 385.954458746 191.017364032 square
grestore
375.954458746 175.017364032 moveto (p1) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
296.055050299 171.776971018 316.055050299 191.776971018 square
grestore
306.055050299 175.776971018 moveto (p2) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor
186.055050299 186.230145803 206.055050299 206.230145803 square
grestore
196.055050299 190.230145803 moveto (p1) showmiddle
0.511904761905 42.0 146.836207801 78.2554790022 oval
146.836207801 78.2554790022 moveto (summary) showmiddle
0.471264367816 43.5 139.768809672 305.815808412 oval
139.768809672 305.815808412 moveto (setup) showmiddle
gsave 0.0 0.0 0.0 setrgbcolor newpath 316.055050299 181.668299571 365.954458746 181.126035479 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 100.0 196.891901242 186.055050299 196.299039155 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 90.9883153136 217.029687945 118.822446983 287.848951639 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 91.2543301102 177.029687945 126.239216061 96.9926193728 1 5 7 arrow stroke grestore
1.121 10.5263157895 224.476102931 152.221891119 oval
1.121 10.5263157895 224.294234975 245.405179082 oval
gsave 0.0 0.0 0.0 setrgbcolor newpath 234.252587651 156.595755391 295.52873451 184.009857404 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 234.252587651 156.595755391 295.52873451 184.009857404 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 224.453072656 164.021862877 224.31726525 233.605207324 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 203.613912962 184.789468099 218.336276055 161.806660729 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor
407.446706808 144.027502558 417.136629289 153.254169225 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
459.764128014 168.814952628 469.454050494 178.041619295 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
407.931202932 245.206732577 417.621125413 254.433399244 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
459.661159389 215.409619295 469.351081869 224.636285962 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
412.291668049 124.988285962 486.904071149 173.428285962 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor
412.776164173 220.022952628 480.605621537 271.230952628 square
grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 464.59889434 178.041619295 464.516315542 215.409619295 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 385.644381227 172.665123578 407.446706808 153.008888198 1 5 7 arrow stroke grestore
gsave 0.0 0.0 0.0 setrgbcolor newpath 380.920073676 190.627894857 410.293356708 245.206732577 1 5 7 arrow stroke grestore
